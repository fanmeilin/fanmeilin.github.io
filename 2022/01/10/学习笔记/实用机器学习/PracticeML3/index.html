

<!DOCTYPE html>

<html lang="zh-CN" data-default-color-scheme=auto>
<script type="text/javascript" src="/js/jquery.js"></script>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#d8afe4">
  <meta name="description" content="ä¸çµé­‚å…±èˆ">
  <meta name="author" content="Meilin Fan">
  <meta name="keywords" content="ä¸ªäººåšå®¢,å­¦ä¹ ,ç”Ÿæ´»">
  
  <title>praticalMLç¬¬ä¸‰ç« ç¬”è®° - å¾…æ—¶</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"fanmeilin.github.io","root":"/","version":"1.8.11","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>	
	<div>
		<div class='real_mask'></div>
		<div id="banner_video_insert">
		</div>	
		<div id='vvd_banner_img'>
		</div>
	</div>
	<div id="banner"></div>
    
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>ä¸çµé­‚å…±èˆ</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

	
	<!-- <div class="banner" id="banner" parallax=true
		style="background: url('https://picture.mulindya.com/03990bbe091d5cca73421ac40bacfc46_1.jpg') no-repeat center center;
		background-size: cover;"> -->
        <div class="banner" id='banner' >
		<div class="full-bg-img" >
		
			
				<script>
					var ua = navigator.userAgent;
					var ipad = ua.match(/(iPad).*OS\s([\d_]+)/),
						isIphone = !ipad && ua.match(/(iPhone\sOS)\s([\d_]+)/),
						isAndroid = ua.match(/(Android)\s+([\d.]+)/),
						isMobile = isIphone || isAndroid;

					function set_video_attr(id){

						var height = document.body.clientHeight
						var width = document.body.clientWidth
						var video_item = document.getElementById(id);

						if (height / width < 0.56){
							video_item.setAttribute('width', '100%');
							video_item.setAttribute('height', 'auto');
						} else {
							video_item.setAttribute('height', '100%');
							video_item.setAttribute('width', 'auto');
						}
					}

					$.getJSON('/js/video_url.json', function(data){
						if (!isMobile){
							var video_list_length = data.length
							var seed = Math.random()
							index = Math.floor(seed * video_list_length)
							
							video_url = data[index][0]
							pre_show_image_url = data[index][1]
							
							banner_obj = document.getElementById("banner")
							banner_obj.style.cssText = "background: url('" + pre_show_image_url + "') no-repeat; background-size: cover;"

							vvd_banner_obj = document.getElementById("vvd_banner_img")

							vvd_banner_content = "<img id='banner_img_item' src='" + pre_show_image_url + "' style='height: 100%; position: fixed; z-index: -999'>"
							vvd_banner_obj.innerHTML = vvd_banner_content

							video_html_res = "<video id='video_item' style='position: fixed; z-index: -888;'  muted='muted' src=" + video_url + " autoplay='autoplay' loop='loop'></video>"
							document.getElementById("banner_video_insert").innerHTML = video_html_res;

							set_video_attr('video_item')
							set_video_attr('banner_img_item')
						}
					});

					if (!isMobile){
						window.onresize = function(){
							set_video_attr('video_item')
							}
						}
				</script>
			

			<!-- <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)"> -->
            <div class="mask flex-center">
			  <div class="page-header text-center fade-in-up">
				<span class="h2" id="subtitle" title="praticalMLç¬¬ä¸‰ç« ç¬”è®°">
				  
				</span>

				
				  <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-01-10 14:27" pubdate>
        2022å¹´1æœˆ10æ—¥ ä¸‹åˆ
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3.3k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      43
       åˆ†é’Ÿ
    </span>
  

  
  
</div>

				
			  </div>

			  
			</div>
		</div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">praticalMLç¬¬ä¸‰ç« ç¬”è®°</h1>
            
            <div class="markdown-body">
              <blockquote>
<p>æ–¯å¦ç¦2021ç§‹å­£çš„å®ç”¨æœºå™¨å­¦ä¹ ä¸Šçº¿å•¦~ ğŸ˜‰ è·Ÿç€æ²ç¥å¤ä¹ æœºå™¨å­¦ä¹ å†²å†²å†²ï¼ è®°å½•ä¸€ä¸‹ç¬”è®°å’Œé‡ç‚¹ï¼Œä¸ä¸€å®šå¾ˆå…¨å“¦~ï¼Œåªæ˜¯è®°å½•è‡ªæˆ‘æ„Ÿè§‰çš„é‡ç‚¹ã€‚<br>
è¿™ä¸€ç« çš„å†…å®¹æ˜¯å¯¹å„ç§æœºå™¨å­¦ä¹ æ¨¡å‹çš„ä»‹ç»ï¼ŒåŒ…æ‹¬æœ‰å†³ç­–æ ‘ï¼Œçº¿æ€§æ¨¡å‹ï¼Œå¤šå±‚æ„ŸçŸ¥æœºï¼Œå·ç§¯ç¥ç»ç½‘ç»œï¼Œå¾ªç¯ç¥ç»ç½‘ç»œã€‚</p>
</blockquote>
<h1>ç¬¬ä¸‰ç«  æœºå™¨å­¦ä¹ æ¨¡å‹</h1>
<h2 id="3-1-æœºå™¨å­¦ä¹ ä»‹ç»ğŸˆ">3.1 æœºå™¨å­¦ä¹ ä»‹ç»ğŸˆ</h2>
<p>åˆ†ç±»å¯ä»¥åˆ†æˆï¼š</p>
<ol>
<li>ç›‘ç£å­¦ä¹ ï¼ˆSurprisedï¼‰ï¼šæœ‰æ ‡å·çš„æ•°æ®ä¸Šæ¥è®­ç»ƒæ¨¡å‹æ¥é¢„æµ‹æ ‡å·
<ul>
<li>è¡ç”Ÿå‡ºç°self-supervised è‡ªç›‘ç£å­¦ä¹ ï¼šå¯ä»¥äº§ç”Ÿæ ‡å·ï¼Œåªæ˜¯å…¶æ ‡å·æ˜¯æ¥è‡ªæ•°æ®æœ¬èº«ï¼ˆeg:word2vec,BERTï¼‰</li>
</ul>
</li>
<li>åŠç›‘ç£å­¦ä¹ ï¼ˆSemi-superisedï¼‰å­˜åœ¨å°éƒ¨åˆ†æœ‰æ ‡å·çš„æ•°æ®ï¼Œè¿˜æœ‰å¤§éƒ¨åˆ†æ²¡æœ‰æ ‡å·çš„æ•°æ®ã€‚
<ul>
<li>egï¼šself-training ä½¿ç”¨è‡ªè®­ç»ƒçš„è¿‡ç¨‹æ¥é¢„æµ‹æ ‡å·å†ä¸€èµ·è®­ç»ƒã€‚</li>
</ul>
</li>
<li>æ— ç›‘ç£å­¦ä¹ ï¼ˆUnsuperisedï¼‰åœ¨æ²¡æœ‰æ ‡å·çš„æ•°æ®ä¸Šè®­ç»ƒ
<ul>
<li>egï¼šclusteringï¼Œdensity estimationï¼ˆGANï¼‰</li>
</ul>
</li>
<li>å¼ºåŒ–å­¦ä¹ ï¼ˆReinforceï¼‰åœ¨ä¸€ä¸ªç¯å¢ƒä¸­äº¤äº’ï¼Œå¹¶ä¸”åŸºäºè§‚å¯Ÿç‚¹æ¥å­¦ä¹ ï¼Œç±»ä¼¼äººç±»å­¦ä¹ çš„æ–¹æ³•ã€‚Use observations from the interaction with the environment to take actions to maximize rewardã€‚</li>
</ol>
<h3 id="3-1-1-ç›‘ç£å­¦ä¹ ä¸­çš„Components">3.1.1 ç›‘ç£å­¦ä¹ ä¸­çš„Components</h3>
<ul>
<li>Modelï¼ˆæ¨¡å‹ï¼‰ ä»è¾“å…¥ä¸­å¾—åˆ°è¾“å‡º</li>
<li>Lossï¼ˆæŸå¤±å‡½æ•°ï¼‰è¯„ä¼°çœŸå®æ ·æœ¬å’Œé¢„æµ‹ç»“æœçš„å·®è·</li>
<li>Objectiveï¼ˆç›®æ ‡å‡½æ•°å¯¹è±¡ï¼‰The goal to optimize model params for</li>
<li>Optimizationï¼ˆä¼˜åŒ–ç®—æ³•ï¼‰he algorithm for solving the objective</li>
</ul>
<h3 id="3-1-2-ç›‘ç£å­¦ä¹ æ¨¡å‹">3.1.2 ç›‘ç£å­¦ä¹ æ¨¡å‹</h3>
<ul>
<li><strong>Decision trees</strong>  â€¢ Use trees to make decisions</li>
<li><strong>Linear methods</strong> â€¢ Decision is made from a linear combination of input featuresï¼ˆåšå†³ç­–çš„è¾“å‡ºæ˜¯è¾“å…¥çš„çº¿æ€§ç»„åˆï¼‰</li>
<li><strong>Kernel machines</strong> â€¢ Use kernel functions to compute feature similarities  ï¼ˆæ ¸å‡½æ•°æ¥è¡¡é‡ä¸¤ä¸ªæ ·æœ¬ç‰¹å¾ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼ŒæŒ‡å®šä¸åŒçš„æ ¸å‡½æ•°ï¼Œç‰¹å¾ç›¸ä¼¼åº¦ä¸åŒï¼Œè¾¾åˆ°éçº¿æ€§çš„æ•ˆæœï¼‰</li>
<li><strong>Neural Networks</strong> â€¢ Use neural networks to learn feature representations</li>
</ul>
<h3 id="3-1-3-æ€»ç»“">3.1.3 æ€»ç»“</h3>
<p><img src="https://picture.mulindya.com/pML3-1.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h2 id="3-2-å†³ç­–æ ‘-ğŸŒ´">3.2 å†³ç­–æ ‘ ğŸŒ´</h2>
<p>åŒ…æ‹¬æœ‰åˆ†ç±»æ ‘ï¼Œå›å½’æ ‘ï¼ˆæ­¤æ—¶å¶å­èŠ‚ç‚¹ä¸æ˜¯ç±»åˆ«è€Œæ˜¯å®æ•°å€¼ï¼‰</p>
<h5 id="å¥½å¤„ï¼ˆprosï¼‰ï¼š">å¥½å¤„ï¼ˆprosï¼‰ï¼š</h5>
<ul>
<li>å¯è§£é‡Šï¼ˆå¯åº”ç”¨äºé“¶è¡Œä¸šï¼Œä¿é™©ä¸šï¼‰ï¼›</li>
<li>å¯ä»¥ç”¨äºæ•°å€¼æˆ–ç±»åˆ«ç‰¹å¾ï¼›</li>
</ul>
<h5 id="ç¼ºç‚¹ï¼ˆconsï¼‰ï¼š">ç¼ºç‚¹ï¼ˆconsï¼‰ï¼š</h5>
<ul>
<li>é²æ£’æ€§å·®ï¼ˆå¯ä»¥ç”¨é›†æˆå­¦ä¹ æ”¹å–„ï¼‰ï¼›</li>
<li>æ•°æ®å¾ˆå¤æ‚æ—¶å¯èƒ½äº§ç”Ÿè¿‡æ‹Ÿåˆï¼ˆå¯ä»¥ä½¿ç”¨å‰ªæï¼‰ï¼›</li>
<li>éš¾ä»¥ä½¿ç”¨å¹¶è¡Œè®¡ç®—</li>
</ul>
<h3 id="3-2-1-ç”Ÿæˆå†³ç­–æ ‘">3.2.1 ç”Ÿæˆå†³ç­–æ ‘</h3>
<p><img src="https://picture.mulindya.com/pML3-2.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h3 id="3-2-2-éšæœºæ£®æ—">3.2.2 éšæœºæ£®æ—</h3>
<p>è®­ç»ƒå¤šä¸ªå†³ç­–æ ‘æ¥å¢å¼ºå¹¶è¡Œæ€§ï¼Œåˆ†ç±»æ—¶ä½¿ç”¨æŠ•ç¥¨æœºåˆ¶ï¼Œå›å½’æ—¶ä½¿ç”¨å¤šä¸ªæ ‘çš„å¹³å‡ï¼›å¯¹æ•´ä¸ªæ ‘çš„ç¨³å®šæ€§æœ‰å¥½å¤„ã€‚</p>
<ul>
<li>Train multiple decision trees to improve robustness<br>
â€¢ Trees are trained independently in parallel<br>
â€¢ Majority voting for classification, average for regression</li>
<li>Where is the randomness from?<br>
â€¢ Bagging: randomly sample training examples with replacement<br>
â€¢ E.g. [1,2,3,4,5]   [1,2,2,3,4]<br>
â€¢ Randomly select a subset of features</li>
</ul>
<p>è¿™é‡Œçš„éšæœºæ£®æ—ä¸­çš„éšæœºæ¥è‡ªäºä¸¤ä¸ªæ–¹é¢å“¦~</p>
<p>ä¸€ä¸ªæ˜¯Baggingï¼Œè®­ç»ƒä¸€æ£µæ ‘åœ¨è®­ç»ƒé›†ä¸­éšæœºé‡‡æ ·ä¸€äº›æ ·æœ¬å‡ºæ¥ï¼ˆå¯é‡å¤é‡‡æ ·ï¼‰ï¼Œæ‰€ä»¥åœ¨è®­ç»ƒé›†ä¸­ä¼šå‡ºç°é‡å¤æ ·æœ¬ï¼Œç»§ç»­é‡å¤è®­ç»ƒå…¶ä»–æ ‘ï¼›</p>
<p>å¦ä¸€ä¸ªæ˜¯å¯¹äºè·å–çš„è®­ç»ƒé›†æ˜¯éšæœºè¿›è¡Œé‡‡æ ·ç‰¹å¾åˆ—ï¼ˆæ­¤æ—¶æ˜¯æ— é‡å¤çš„ç‰¹å¾åˆ—é‡‡æ ·ï¼‰ï¼›</p>
<h3 id="3-2-3-Gradient-Boosting-Decision-Trees">3.2.3 Gradient Boosting Decision Trees</h3>
<p>è®­ç»ƒå¤šæ£µæ ‘ï¼Œä½†æ˜¯è¿™é‡Œä¸æ˜¯ç‹¬ç«‹å®Œæˆå†³ç­–ï¼Œè€Œæ˜¯é¡ºåºçš„å®Œæˆï¼Œåˆ©ç”¨è¿™äº›æ ‘æ¥åˆæˆä¸€ä¸ªå¤§çš„æ¨¡å‹å‡ºæ¥ï¼Œåœ¨tæ—¶åˆ» $ F_t(x) $ è¡¨ç¤ºæ˜¯å¯¹å‰é¢è®­ç»ƒçš„t-1æ£µæ ‘æ±‚å’Œï¼Œè®­ç»ƒçš„è¿™é¢—æ ‘éœ€è¦å’Œæ‰€æœ‰çš„æ ‘çš„ç»“æœåŠ èµ·æ¥ï¼Œåˆ©ç”¨æ®‹å·®çš„æ€æƒ³è®­ç»ƒ$f_t(x)$ï¼ˆä¹Ÿå°±æ˜¯â€œä¸å‡†â€çš„éƒ¨åˆ†ï¼‰</p>
<p>åŒæ—¶è¿™é‡Œçš„æ®‹å·®ï¼ˆ$y_i-F_t(x_i)$ï¼‰å°±ç­‰äºæ¢¯åº¦å€¼($ -\frac{\alpha L}{\alpha F} $)ï¼ˆä½¿ç”¨å‡æ–¹è¯¯å·®ä½œä¸ºlossï¼‰</p>
<p><img src="https://picture.mulindya.com/pML3-3.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h3 id="3-2-3-æ€»ç»“">3.2.3 æ€»ç»“</h3>
<ul>
<li>Decision tree: an explainable model for classification/regression</li>
<li>Easy to train and tune, widely used in industry</li>
<li>Sensitive to data<br>
â€¢ Ensemble can help (more on bagging and boosting latter)</li>
</ul>
<p>å†³ç­–æ ‘æ˜¯ä¸€ä¸ªä¸ºæ•°ä¸å¤šçš„å¯è§£é‡Šæ€§æ¨¡å‹ï¼Œå¯¹æ•°æ®çš„å™ªéŸ³å¾ˆæ•æ„Ÿæ‰€ä»¥å¯ä»¥ä½¿ç”¨å¾ˆå¤šæ ‘ä¸€èµ·è®­ç»ƒæ¥é™ä½åç§»å’Œæ–¹å·®ã€‚å¯ä»¥ç”¨æ ‘æ¨¡å‹æ—¶å°½é‡ç”¨æ ‘æ¨¡å‹å“Ÿã€‚</p>
<h2 id="3-3-çº¿æ€§å›å½’-ğŸ“ˆ">3.3 çº¿æ€§å›å½’ ğŸ“ˆ</h2>
<h3 id="3-3-1-æ¦‚å¿µ">3.3.1 æ¦‚å¿µ</h3>
<p><img src="https://picture.mulindya.com/pML3-4.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>x*wæ˜¯æŒ‰å…ƒç´ æ¥åšä¹˜ç§¯å¾—åˆ°è¿˜æ˜¯ä¸€ä¸ªå‘é‡ï¼ˆlistï¼‰</p>
<h3 id="3-3-2-ç›®æ ‡å‡½æ•°">3.3.2 ç›®æ ‡å‡½æ•°</h3>
<p><img src="https://picture.mulindya.com/pML3-5.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>å­¦ä¹ å‚æ•°wï¼Œbï¼›åœ¨æ‰€æœ‰æ ·æœ¬ä¸­æ±‚å‡æ–¹è¯¯å·®ï¼Œæœ€å°åŒ–MSEã€‚</p>
<h3 id="3-3-3-ä½¿ç”¨çº¿æ€§å›å½’æ¥åˆ†ç±»">3.3.3 ä½¿ç”¨çº¿æ€§å›å½’æ¥åˆ†ç±»</h3>
<p><img src="https://picture.mulindya.com/pML3-6.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ä½¿ç”¨çº¿æ€§å›å½’çš„äºŒåˆ†ç±»ç§°ä¸ºé€»è¾‘å›å½’ï¼›</p>
<p>è¿™é‡Œç±»åˆ«æ•°ä¸ºmï¼ŒçœŸå®æ ‡å·yæ˜¯one-hotå‘é‡ï¼ŒOiä¹Ÿæ˜¯ä¸€ä¸ªé•¿åº¦ä¸ºmçš„å‘é‡ï¼ŒWiä¸ºçŸ©é˜µå½¢å¼ï¼Œç›®æ ‡å‡½æ•°ä¾ç„¶æ˜¯æœ€å°åŒ–å‡æ–¹è¯¯å·®ã€‚ç±»ä¼¼æ²¡æœ‰éšè—å±‚çš„â€ç¥ç»ç½‘ç»œâ€œã€‚</p>
<h3 id="3-3-4-Softmax-Regression">3.3.4 Softmax Regression</h3>
<p><img src="https://picture.mulindya.com/pML3-7.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>è¿™ç§æ–¹æ³•çš„ä¾§é‡ç‚¹æ˜¯æœ€å¤§åŒ–one-hotä¸­æ­£ç¡®æ ·æœ¬çš„å€¼ï¼Œå¯¹å…¶ä»–æ ·æœ¬ç‚¹å€¼ç½®ä¿¡åº¦ä¸ä¼šå¼ºåˆ¶é€¼è¿‘ä¸º0ã€‚é¿å…ç²¾åŠ›é›†ä¸­äºone-hotä¸­å…¶ä»–æ ·æœ¬ä¸º0çš„æ‹Ÿåˆï¼›é¦–å…ˆæŠŠè¾“å‡ºè½¬åŒ–ä¸ºæ¦‚ç‡åˆ†å¸ƒçš„å½¢å¼ï¼Œè¿™é‡Œè™½ç„¶å‡ºç°äº†éçº¿æ€§å˜æ¢ï¼ˆä½¿ç”¨softmaxï¼‰ï¼Œä½†æ˜¯æ­¤å†³ç­–æ–¹æ³•è¿˜æ˜¯çº¿æ€§æ¨¡å‹ã€‚</p>
<p>æ­¤æ—¶æ¯”è¾ƒä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œä½¿ç”¨äº¤å‰ç†µæ¥è¡¡é‡å‘é‡çš„å·®åˆ«ï¼Œåªç”¨å…³æ³¨çœŸå®ç±»çš„å€¼ï¼Œè®©å…¶è¶Šå¤§è¶Šå¥½ã€‚</p>
<h2 id="3-4-éšæœºæ¢¯åº¦ä¸‹é™-ğŸ“‰">3.4 éšæœºæ¢¯åº¦ä¸‹é™ ğŸ“‰</h2>
<p><img src="https://picture.mulindya.com/pML3-8.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>æ±‚è§£æœ€ä¼˜è§£çš„æ–¹æ³•å¯ä»¥ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™çš„æ–¹æ³•ï¼Œçº¿æ€§å›å½’ä¸­çš„bæ˜¯åœ¨è¾“å…¥çš„Xä¸­å¢åŠ ä¸€è¡Œ1,æ‰€ä»¥è¿™é‡Œçš„bè¡¨ç¤ºæ‰¹é‡å¤§å°ã€‚<br>
$$<br>
O = W^TX+b<br>
$$<br>
åœ¨Xä¸­åŠ ä¸€è¡Œå…¨1æ•°æ®<br>
$$<br>
O = W^TX<br>
$$<br>
å¯ä»¥è§£å†³é™¤äº†å†³ç­–æ ‘ä»¥å¤–çš„å…¶ä»–ç®—æ³•ï¼ˆè¯¾å†…ï¼‰çš„æ”¶æ•›ï¼Œè¶…å‚æ•°æ˜¯bå’Œnï¼›</p>
<h3 id="3-4-1-ä»£ç ">3.4.1 ä»£ç </h3>
<p>â€¢ Train a linear regression model with min-batch SGD<br>
â€¢ Hyperparameters<br>
â€¢ batch_size<br>
â€¢ learning_rate<br>
â€¢ num_epochs</p>
<p>è¿™é‡Œæ˜¯è¾“å‡ºä¸€ä¸ªç»“æœå€¼è€Œéå‘é‡ï¼Œå› ä¸ºè¿™é‡Œæ˜¯å›å½’å“Ÿ~</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># `features` shape is (n, p),æ ·æœ¬æ•° ç‰¹å¾æ•° `labels` shape is (n, 1) </span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">data_iter</span>(<span class="hljs-params">batch_size, features, labels</span>):</span> <span class="hljs-comment">#å°æ‰¹é‡çš„è¯»å–</span><br>    num_examples = <span class="hljs-built_in">len</span>(features)  <span class="hljs-comment">#æ ·æœ¬æ•°</span><br>    indices = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(num_examples)) <br>    random.shuffle(indices)  <span class="hljs-comment"># read examples at random  éšæœºé‡‡æ ·</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, num_examples, batch_size): <br>        batch_indices = torch.tensor( <br>            indices[i:<span class="hljs-built_in">min</span>(i + batch_size, num_examples)]) <br>        <span class="hljs-keyword">yield</span> features[batch_indices], labels[batch_indices] <span class="hljs-comment">#yieldæ˜¯ä¸€ä¸ªåå¤çš„æ“ä½œï¼Œä¼šåˆ›å»ºè¿­ä»£å™¨ï¼Œå¯ä»¥ç”¨foræ¥éå†</span><br>w = torch.normal(<span class="hljs-number">0</span>, <span class="hljs-number">0.01</span>, size=(p, <span class="hljs-number">1</span>), requires_grad=<span class="hljs-literal">True</span>) <br>b = torch.zeros(<span class="hljs-number">1</span>, requires_grad=<span class="hljs-literal">True</span>) <br><span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_epochs): <br>    <span class="hljs-keyword">for</span> X, y <span class="hljs-keyword">in</span> data_iter(batch_size, features, labels): <br>        y_hat = X @ w + b  <span class="hljs-comment">#@æ˜¯ç”¨æ¥å¯¹tensorè¿›è¡ŒçŸ©é˜µç›¸ä¹˜çš„ï¼›*ç”¨æ¥å¯¹tensorè¿›è¡ŒçŸ©é˜µè¿›è¡Œé€å…ƒç´ ç›¸ä¹˜ï¼›</span><br>        loss = ((y_hat - y)**<span class="hljs-number">2</span> / <span class="hljs-number">2</span>).mean() <span class="hljs-comment">#å‡æ–¹è¯¯å·®</span><br>        loss.backward()  <span class="hljs-comment">#æ±‚å¯¼</span><br>        <span class="hljs-keyword">for</span> param <span class="hljs-keyword">in</span> [w, b]: <span class="hljs-comment"># å¯¹wï¼Œbæ›´æ–°</span><br>            param -= learning_rate * param.grad   <span class="hljs-comment">#æ¢¯åº¦æ›´æ–°</span><br>            param.grad.zero_()  <span class="hljs-comment">#æ¢¯åº¦æ¸…é›¶</span><br></code></pre></td></tr></tbody></table></figure>
<h3 id="3-4-2-æ€»ç»“">3.4.2 æ€»ç»“</h3>
<p>â€¢ Linear methods linearly combine inputs to obtain predictions<br>
â€¢ Linear regression uses MSE as the loss function<br>
â€¢ Softmax regression is used for multiclass classification<br>
â€¢ Turn predictions into probabilities and use cross-entropy as loss<br>
â€¢ Cross entropy loss between two probability distribution<br>
â€¢ Mini-batch SGD can learn both models (and later neural networks as well)</p>
<h2 id="3-5-ç¥ç»ç½‘ç»œ-âœï¸">3.5 ç¥ç»ç½‘ç»œ âœï¸</h2>
<p>â€¢ NN usually requires more data and more computation<br>
â€¢ NN architectures to model data structures<br>
â€¢ Multilayer perceptions<br>
â€¢ Convolutional neural networks<br>
â€¢ Recurrent neural networks<br>
â€¢ Transformer<br>
â€¢ Design NN to incorporate prior knowledge about the data</p>
<p>ä½¿ç”¨æœºå™¨æ¥æå–ç‰¹å¾æ¯”æ‰‹åŠ¨æå–ç‰¹å¾è¦å¥½ï¼Œä½†æ˜¯éœ€è¦æ›´å¤šçš„æ•°æ®ï¼Œå¯èƒ½æ•°æ®é›†å¤§äº†1000å€ã€‚</p>
<h3 id="3-5-1-å¤šå±‚æ„ŸçŸ¥æœº">3.5.1 å¤šå±‚æ„ŸçŸ¥æœº</h3>
<p><img src="https://picture.mulindya.com/pML3-9.png" srcset="/img/loading.gif" lazyload alt=""></p>
<ul>
<li>
<p>çº¿æ€§å›å½’ç›¸å½“äºæ˜¯m=1çš„å…¨è¿æ¥å±‚</p>
</li>
<li>
<p>Softmaxå›å½’æ˜¯mä¸ºmçš„å…¨è¿æ¥å±‚</p>
</li>
</ul>
<h4 id="MLP">MLP</h4>
<p>é€šè¿‡æ¿€æ´»å‡½æ•°æ¥æ„å»ºéçº¿æ€§æ¨¡å‹</p>
<ul>
<li>
<p>Activation is a elemental-wise non-linear function</p>
<p>eg:</p>
</li>
</ul>
<p>$$<br>
sigmoid(x) = \frac{1}{1+e^{(-x)}}<br>
$$</p>
<p>$$<br>
Relu(x) = max(x,0)<br>
$$<br>
â€‹	â€¢ It leads to non-linear models</p>
<ul>
<li>Stack multiple hidden layers  (dense + activation) to get deeper models å †å éšè—å±‚</li>
<li>Hyper-parameters:<br>
# hidden layers, # outputs of each hidden layer</li>
<li>Universal approximation theorem</li>
</ul>
<h4 id="code">code</h4>
<p>â€¢ MLP with 1 hidden layer<br>
â€¢ Hyperparameter: num_hiddens</p>
<p>ä¸€ä¸ªéšè—å±‚H æœ€ååšä¸€ä¸ªçº¿æ€§æ˜ å°„è¾“å‡ºã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">relu</span>(<span class="hljs-params">X</span>):</span> <br>    <span class="hljs-keyword">return</span> torch.<span class="hljs-built_in">max</span>(X, <span class="hljs-number">0</span>) <br>W1 = nn.Parameter(torch.randn(num_inputs, num_hiddens) * <span class="hljs-number">0.01</span>) <br>b1 = nn.Parameter(torch.zeros(num_hiddens)) <br>W2 = nn.Parameter(torch.randn(num_hiddens, num_outputs) * <span class="hljs-number">0.01</span>) <br>b2 = nn.Parameter(torch.zeros(num_outputs)) <br>H = relu(X @ W1 + b1) <br>Y = H @ W2 + b2 <br></code></pre></td></tr></tbody></table></figure>
<h3 id="3-5-2-å·ç§¯ç¥ç»ç½‘ç»œ">3.5.2 å·ç§¯ç¥ç»ç½‘ç»œ</h3>
<h4 id="å¼•å…¥">å¼•å…¥</h4>
<ul>
<li>Learn ImageNet (300x300 images with 1K classes) by a MLP with a single hidden layer with 10K outputs<br>
â€¢ It leads to 1 billion learnable parameters, thatâ€™s too big!<br>
â€¢ Fully connected: an output is a weighted sum over all inputs</li>
<li>Recognize objects in images<br>
â€¢ <strong>Translation invariance</strong>: similar output  no matter where the object is<br>
â€¢ <strong>Locality</strong>: pixels are more related to  near neighbors</li>
<li>Build the prior knowledge into the model structure<br>
â€¢ Achieve same model capacity with less # params</li>
</ul>
<p>ç”±äºå…¨è¿æ¥å±‚çš„å‚æ•°é‡ä¸ºm*nï¼Œçº¯ç”¨MLPå‚æ•°é‡å¤ªå¤§äº†ï¼Œå¼•ç”¨å·ç§¯å±‚</p>
<p>å¯¹äºå›¾åƒæœ‰ä¸¤å¤§ç‰¹æ€§</p>
<ol>
<li>å˜æ¢ä¸å˜æ€§ï¼šè¡¨ç¤ºåŒä¸€objectåœ¨å›¾åƒåŒºåŸŸçš„å˜æ¢å¯¹ç»“æœæ²¡æœ‰å½±å“ï¼›</li>
<li>æœ¬åœ°æ€§ï¼šæŸä¸€åƒç´ ä¸é™„è¿‘çš„åƒç´ ç‚¹çš„å…³è”åº¦è¾ƒé«˜ï¼Œè¿œå¤„çš„å…³è”åº¦æ¯”è¾ƒä½ï¼›</li>
</ol>
<h4 id="å…·ä½“æœºåˆ¶">å…·ä½“æœºåˆ¶</h4>
<p><img src="https://picture.mulindya.com/pML3-10.png" srcset="/img/loading.gif" lazyload alt=""></p>
<ul>
<li>
<p>æœ¬åœ°æ€§ï¼šå·ç§¯å±‚çš„ä¸€ä¸ªè¾“å‡ºåªæ˜¯æ¥æºäºk*kçš„ä¸€ä¸ªåƒç´ å—è¿›è¡Œå±€éƒ¨è®¡ç®—ï¼›</p>
</li>
<li>
<p>å¹³ç§»ï¼ˆ/å˜æ¢ï¼‰ä¸å˜æ€§ï¼šåœ¨ä¸€ä¸ªfeature mapçš„channelä¸Šä½¿ç”¨ç›¸åŒå·ç§¯æ ¸ï¼Œæƒé‡å…±äº«ï¼Œå› ä¸ºå’Œä½ç½®æ— å…³ã€‚</p>
</li>
</ul>
<p>æ‰€ä»¥æ¨¡å‹çš„å‚æ•°é‡åªä¸kæœ‰å…³ï¼Œä¸è¾“å…¥è¾“å‡ºçš„å¤§å°æ— å…³ï¼›å·ç§¯æ ¸é€šå¸¸æ˜¯ä¼šè¢«å­¦ä¹ æˆå»è¯†åˆ«ä¸€ä¸ªå›¾åƒä¸­çš„patternã€‚</p>
<h4 id="ä»£ç ">ä»£ç </h4>
<p>å•é€šé“å·ç§¯çš„å®ç°ï¼Œkæ˜¯kernelçš„æƒé‡ï¼ŒYæ˜¯æœ€åçš„è¾“å‡ºï¼Œå…¶ç»´åº¦æ˜¯Xçš„å®½é«˜å‡å»å¯¹åº”çš„kå®½é«˜å†åŠ 1ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># both input `X` and weight `K` are matrices </span><br>h, w = K.shape <br>Y = torch.zeros((X.shape[<span class="hljs-number">0</span>] - h + <span class="hljs-number">1</span>, X.shape[<span class="hljs-number">1</span>] - w + <span class="hljs-number">1</span>)) <br><span class="hljs-comment"># stride = 1 </span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Y.shape[<span class="hljs-number">0</span>]):   <br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Y.shape[<span class="hljs-number">1</span>]): <br>        Y[i, j] = (X[i : i+h, j : j+w] * K).<span class="hljs-built_in">sum</span>() <span class="hljs-comment">#ç‚¹ä¹˜å†æ±‚å’Œçš„è®¡ç®—ç§°ä¸ºäº¤å‰ç›¸å…³</span><br></code></pre></td></tr></tbody></table></figure>
<h4 id="Pooling-Layer-æ±‡èšå±‚">Pooling Layer æ±‡èšå±‚</h4>
<p>å·ç§¯å±‚å¯¹è¾“å…¥çš„ä½ç½®æ•æ„Ÿï¼Œå¦‚æœè¾“å…¥çš„objectç§»åŠ¨ä¸€ä¸ªå¾®å°è·ç¦»å¯¹åº”çš„è¾“å‡ºä¹Ÿä¼šå‡ºç°ç§»åŠ¨ï¼Œè¿™æ ·é²æ£’æ€§ä¼šé™ä½ï¼Œé€šè¿‡æ± åŒ–å±‚ï¼ˆæ±‡èšå±‚ï¼‰å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>æ¯ä¸€æ¬¡åœ¨K*Kçš„çª—å£ä¸­ä½¿ç”¨å¹³å‡æ±‡èšæˆ–è€…æœ€å¤§æ±‡èšï¼Œè¿™æ ·å¯¹Kä¸ªåƒç´ çš„åç§»å°±ä¸ä¼šå¤ªå¤§å½±å“ã€‚</p>
<ul>
<li>Convolution is sensitive to location<br>
â€¢ A translation/rotation of a pattern in the input results similar changes of a pattern in the output</li>
<li>A pooling layer computes mean/max in windows of size k Ã— k</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># h, w: pooling window height and width </span><br><span class="hljs-comment"># mode: max or avg </span><br>Y = torch.zeros((X.shape[<span class="hljs-number">0</span>] - h + <span class="hljs-number">1</span>, X.shape[<span class="hljs-number">1</span>] - w + <span class="hljs-number">1</span>)) <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Y.shape[<span class="hljs-number">0</span>]): <br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Y.shape[<span class="hljs-number">1</span>]): <br>        <span class="hljs-keyword">if</span> mode == <span class="hljs-string">'max'</span>: <br>            Y[i, j] = X[i : i+h, j : j+w].<span class="hljs-built_in">max</span>() <br>        <span class="hljs-keyword">elif</span> mode == <span class="hljs-string">'avg'</span>: <br>            Y[i, j] = X[i : i+h, j : j+w].mean()<br></code></pre></td></tr></tbody></table></figure>
<h4 id="å·ç§¯ç¥ç»ç½‘ç»œ">å·ç§¯ç¥ç»ç½‘ç»œ</h4>
<ul>
<li>Stacking convolution layers to extract features<br>
â€¢ Activation is applied after each convolution layer<br>
â€¢ Using pooling to reduce location sensitivity</li>
<li>Modern CNNs are deep neural network with various hyper-parameters and layer connections (AlexNet, VGG, Inceptions, ResNet, MobileNet)</li>
</ul>
<p>å·ç§¯ç¥ç»ç½‘ç»œæŠŠå·ç§¯å±‚å †å èµ·æ¥ï¼Œä½¿ç”¨å·ç§¯å±‚æŠ½å–ç©ºé—´ä¿¡æ¯ï¼Œæ»¡è¶³å˜æ¢ä¸å˜æ€§å’Œæœ¬åœ°æ€§çš„ç‰¹å¾ã€‚æ¿€æ´»å±‚åœ¨å·ç§¯å±‚ä¹‹åï¼Œå·ç§¯å±‚æ˜¯ä¸€ç§ç‰¹æ®Šçš„å…¨è¿æ¥å±‚ï¼ˆæ¯æ¬¡åªçœ‹å°çª—å£ï¼Œå…¶ä»–æƒé‡ä¸º0ï¼‰ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯çº¿æ€§å˜æ¢ï¼Œæ‰€ä»¥éœ€è¦æ¿€æ´»å±‚æ¥éçº¿æ€§åŒ–ï¼›åŒæ—¶ä½¿ç”¨æ±‡èšå±‚æ¥é™ä½å·ç§¯å±‚å¯¹ä½ç½®çš„æ•æ„Ÿæ€§ã€‚</p>
<blockquote>
<p>lenet = nn.Sequential(<br>
nn.Conv2d(â€¦),<br>
nn.Sigmoid(),<br>
nn.AvgPool2d(â€¦),<br>
nn.Conv2d(),<br>
nn.Sigmoid(),<br>
nn.AvgPool2d(â€¦),<br>
nn.Flatten(),<br>
nn.Linear(â€¦),<br>
nn.Sigmoid(),<br>
nn.Linear(â€¦),<br>
nn.Sigmoid(),<br>
nn.Linear(â€¦))</p>
</blockquote>
<h3 id="3-5-3-å¾ªç¯ç¥ç»ç½‘ç»œ">3.5.3 å¾ªç¯ç¥ç»ç½‘ç»œ</h3>
<p>è¯­è¨€æ¨¡å‹ä¸­è®¾è®¡å¾ªç¯ç¥ç»ç½‘ç»œï¼Œé€šè¿‡å‰é¢çš„ä¿¡æ¯æ¥é¢„æµ‹å½“å‰ä¿¡æ¯ï¼Œæ—¶é—´åºåˆ—ä¿¡æ¯ä¸­é€šè¿‡å‰é¢å‡ ä¸ªé¡¹æ¥é¢„æµ‹åä¸€ä¸ªé¡¹ã€‚</p>
<p>ä½¿ç”¨Denseæ—¶ç”±å‰ä¸€ä¸ªè¯ä½œä¸ºè¾“å…¥é¢„æµ‹å½“å‰è¯ï¼Œå½“æ—¶æ— æ³•è·å–æ—¶é—´åºåˆ—ä¿¡æ¯ï¼Œå› ä¸ºè¾“å…¥é•¿åº¦ç»´åº¦ä¸å¯éšæ„å˜åŒ–ã€‚æ‰€ä»¥è¿™é‡Œéœ€è¦å¯¹æ—¶åºä¿¡æ¯æ·»åŠ åˆ°è¾“å…¥ä¸­ï¼Œä¹Ÿå°±æ˜¯RNNï¼Œå¯ä»¥å°†å‰é¢çš„è¾“å‡ºï¼ˆéšè—å±‚ï¼‰æ·»åŠ è¿›å…¥å½“å‰å±‚çš„è¾“å…¥ã€‚<strong>æ³¨æ„è¿™é‡Œçš„å¯¹æ¯ä¸ªè¯æƒé‡æ˜¯ä¸€æ ·çš„</strong>ï¼ˆåç»­ä»£ç ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼‰ã€‚</p>
<h4 id="Denseä¸Recurrent-networks">Denseä¸Recurrent networks</h4>
<p><img src="https://picture.mulindya.com/pML3-11.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h4 id="RNNå’Œå˜ç§">RNNå’Œå˜ç§</h4>
<p><img src="https://picture.mulindya.com/pML3-12.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>æ³¨æ„éšè—å±‚æ˜¯ç»è¿‡æ¿€æ´»å±‚æ¿€æ´»ä¹‹åå†è¾“å…¥ï¼Œå¢åŠ å‰å‘éšè—å±‚ã€‚<br>
$$<br>
h_t = \sigma(W_{hh}h_{t-1}+W_{hx}x_t+b_h)<br>
$$<br>
æœ‰äº›å˜ç§ä¼šæ¶‰åŠé—¨æ¥æŠ‘åˆ¶æŸäº›ä¿¡æ¯æ¯”å¦‚LSTMï¼ŒGRUï¼Œä¼šå¯¹ä¿¡æ¯æµè¿›è¡Œç»†è‡´çš„æ§åˆ¶ï¼Œæ¯”å¦‚å¯¹è¿‡å»æˆ–è€…ç°åœ¨çš„ä¿¡æ¯é‡‡å–é—å¿˜ã€æŠ‘åˆ¶ï¼Œè¿™ç§æ“ä½œä¹Ÿæ˜¯é€šè¿‡ä¸€ç»„æƒé‡æ¥å­¦ä¹ å†³å®šæ˜¯å¦å¯¹ç‰¹å®šä¿¡æ¯æŠ‘åˆ¶ã€‚</p>
<h4 id="ä»£ç -2">ä»£ç </h4>
<p>å®ç°ç®€å•çš„RNNã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">W_xh = nn.Parameter(torch.randn(num_inputs, num_hiddens) * <span class="hljs-number">0.01</span>) <br>W_hh = nn.Parameter(torch.randn(num_hiddens, num_hiddens) * <span class="hljs-number">0.01</span>)  <span class="hljs-comment">#å¤šå‡ºæ¥çš„</span><br>b_h = nn.Parameter(torch.zeros(num_hiddens)) <br>H = torch.zeros(num_hiddens) <br>outputs = [] <br><span class="hljs-comment">#æŠŠæ¯ä¸ªè¯æ”¾å…¥ä½œä¸ºè¾“å…¥</span><br><span class="hljs-keyword">for</span> X <span class="hljs-keyword">in</span> inputs:  <span class="hljs-comment"># `inputs` shape : (num_steps, batch_size, num_inputs)  num_stepsè¡¨ç¤ºä¸€ç»„è¾“å…¥ å„ä¸ªè¯</span><br>    H = torch.tanh(X @ W_xh + H @ W_hh + b_h)  <span class="hljs-comment">#å¯¹æ¯ä¸ªè¯å…¶å®æƒé‡æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ç»˜å›¾çš„æ—¶å€™æ–¹ä¾¿è¡¨ç¤ºå±•å¼€æ‹‰é•¿</span><br>    outputs.append(H)<br></code></pre></td></tr></tbody></table></figure>
<h4 id="Bi-RNN-and-Deep-RNN">Bi-RNN and Deep RNN</h4>
<p><img src="https://picture.mulindya.com/pML3-13.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>å¯ä»¥ä»åŒå‘æ¥æ£€ç´¢ï¼Œè¿™æ ·ytçš„ä¿¡æ¯æ¥æºæ˜¯å®ƒä¸¤ä¾§çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å®Œå½¢å¡«ç©ºï¼Œæ˜¯å¯ä»¥è·å–åŒå‘ä¿¡æ¯å“¦ã€‚</p>
<h4 id="æ¨¡å‹é€‰æ‹©">æ¨¡å‹é€‰æ‹©</h4>
<p>ä¸åŒçš„æ¨¡å‹ä½¿ç”¨ä¸ä¸åŒæ•°æ®ï¼Œè¡¨æ ¼æ•°æ®ä½¿ç”¨ä¸€èˆ¬æ ‘æ¨¡å‹ï¼Œçº¿æ€§æ¨¡å‹ï¼Œç¥ç»ç½‘ç»œã€‚Transformerå¯¹æ–‡æœ¬å’Œå›¾åƒéƒ½å¯ä»¥å¤„ç†ï¼Œå®é™…ä¸Šæ–‡æœ¬ä¿¡æ¯å’Œå›¾åƒä¿¡æ¯æœ‰ç›¸ä¼¼çš„å†…éƒ¨ç‰¹æ€§ï¼Œåªæ˜¯ç»´åº¦ä¸ä¸€æ ·è€Œå·²ã€‚</p>
<p><img src="https://picture.mulindya.com/pML3-14.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h3 id="3-5-4-æ€»ç»“">3.5.4 æ€»ç»“</h3>
<p>â€¢ MLP: stack dense layers with non-linear activations<br>
â€¢ CNN: stack convolution activation and pooling layers to efficient extract spatial information<br>
â€¢ RNN: stack recurrent layers to pass temporal information through hidden state</p>
<p>CNNï¼šé«˜æ•ˆæŠ“å–ç©ºé—´ä¿¡æ¯</p>
<p>RNNï¼šæŒç»­ä¿¡æ¯çš„æ•°æ®ï¼Œæ¯”å¦‚å¯¹æ—¶åºä¿¡æ¯ã€‚</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">å­¦ä¹ ç¬”è®°</a>
                    
                      <a class="hover-with-bg" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ </a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ </a>
                    
                      <a class="hover-with-bg" href="/tags/%E6%9D%8E%E6%B2%90/">ææ²</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/01/11/deep_learning/conv3d/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">æ·±åº¦ç†è§£3Då·ç§¯</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/01/06/deep_learning/dsconv/">
                        <span class="hidden-mobile">Depthwise Separable Convolution</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    
      <script type="text/javascript">
        var disqus_config = function() {
          this.page.url = 'https://fanmeilin.github.io/2022/01/10/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%AE%9E%E7%94%A8%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/PracticeML3/';
          this.page.identifier = '/2022/01/10/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%AE%9E%E7%94%A8%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/PracticeML3/';
        };
        Fluid.utils.loadComments('#disqus_thread', function() {
          var d = document, s = d.createElement('script');
          s.src = '//' + 'fluid' + '.disqus.com/embed.js';
          s.setAttribute('data-timestamp', new Date());
          (d.head || d.body).appendChild(s);
        });
      </script>
    
    <noscript>Please enable JavaScript to view the comments</noscript>
  </div>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header vvd_contents"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- ä¸è’œå­ç»Ÿè®¡PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            æ€»è®¿é—®é‡ 
            <span id="busuanzi_value_site_pv"></span>
             æ¬¡
          </span>
      
      
        <!-- ä¸è’œå­ç»Ÿè®¡UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            æ€»è®¿å®¢æ•° 
            <span id="busuanzi_value_site_uv"></span>
             äºº
          </span>
      
    
  </div>
  <div class="statistics">
    <a target="_blank" rel="noopener" href="https://developer.hitokoto.cn/" id="hitokoto_text"><span style="color: #DDD;"  id="hitokoto"></span></a>
 <script src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto" defer></script>
  </div>


  
  <!-- å¤‡æ¡ˆä¿¡æ¯ -->
  <div class="beian">
    <span>
      <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
        é„‚ICPå¤‡2021014492-1å·
      </a>
    </span>
    
  </div>


  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.4/es5/tex-svg.js" ></script>

  





  <script  src="https://cdn.jsdelivr.net/npm/mermaid@8.10.1/dist/mermaid.min.js" ></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({"theme":"default"});
    }
  </script>




  

  

  

  

  

  





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"left","width":260,"height":480},"mobile":{"show":false},"react":{"opacity":0.9}});</script></body>
</html>
